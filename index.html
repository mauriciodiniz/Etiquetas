<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Impressão de Etiqueta 58mm — 88ml Delivery</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    :root{
      --label-size:50mm;
      --pad:6px;
      --line:#333;
      --font-family: 'Arial', sans-serif;
    }

    body{
      font-family:var(--font-family);
      display:flex;
      gap:20px;
      padding:20px;
      flex-wrap:wrap;
      background:#f5f5f5;
    }

    .controls{min-width:320px;flex:1}
    label{display:block;margin:8px 0 4px;font-weight:600}
    input[type="text"], input[type="number"]{
      width:100%;
      padding:8px;
      font-size:16px;
      box-sizing:border-box;
      border-radius:8px;
      border:1px solid #ccc;
    }
    button{
      margin-top:12px;
      padding:10px 14px;
      font-size:16px;
      cursor:pointer;
      border-radius:8px;
      border:none;
      background:#333;
      color:white;
    }

    .label-preview{
      width:var(--label-size);
      height:var(--label-size);
      padding:var(--pad);
      box-sizing:border-box;
      background:white;
      flex-shrink:0;
      border-radius:6px;
      display:flex;
      align-items:center;
      justify-content:center;
      margin-bottom:10mm;
    }

    .etiqueta{
      width:100%;
    }

    .company{font-size:11px;text-align:center;font-weight:600}
    .cnpj{font-size:9px;text-align:center;margin-top:2px}
    .divider{border-top:1px solid var(--line);margin:4px 0}
    .product{font-weight:700;font-size:14px;text-align:center;margin:4px 0}
    .bold-large{font-weight:700;font-size:13px;text-align:center}

    .row{display:flex;flex-direction:column;align-items:flex-start;font-size:11px; gap:2px;}
    .peso{font-size:11px}
    .peso b{font-weight:700}
    .preco{font-size:11px}
    .preco b{font-weight:700}

    .total{font-weight:700;font-size:11px;text-align:right;margin-top:6px}
    .total-value{font-size:18px; font-weight:900; margin-left:2px}

    @media print{
      body *{visibility:hidden}
      .label-preview, .label-preview *{visibility:visible}
      .label-preview{position:relative;left:0;top:0;margin:0 auto 10mm auto;border:none;width:var(--label-size);height:var(--label-size);padding-left:0;padding-right:0;}
      @page{size:auto; margin:0}
      .company{font-size:13px;font-weight:700}
    }

    .store-name{font-weight:700}
    .product-name{font-weight:900;font-size:15px;letter-spacing:0.6px}

    @media(max-width:768px){
      body{flex-direction:column}
      .controls{width:100%}
      .label-preview{margin-top:20px;align-self:center}
    }
  </style>
</head>
<body>
  <div class="controls">
    <h2>Gerador de Etiqueta 58mm — 88ml</h2>

    <label for="nome">NOME:</label>
    <input id="nome" type="text" placeholder="Ex: ANCHO ESTÂNCIA 92">

    <label for="peso">PESO (kg):</label>
    <input id="peso" type="text" placeholder="0,952">

    <label for="preco">R$/KG:</label>
    <input id="preco" type="text" placeholder="79,90">

    <label for="total">TOTAL:</label>
    <input id="total" type="text" readonly placeholder="Calculado automaticamente">

    <button id="atualizar">Atualizar Pré-visualização</button>
    <button id="imprimir">IMPRIMIR</button>

    <p style="margin-top:10px;font-size:12px;color:#444">Dica: use uma impressora térmica/laser configurada para papel de 58mm. O botão <strong>IMPRIMIR</strong> abrirá a janela de impressão do navegador exibindo apenas a etiqueta.</p>
  </div>

  <div class="label-preview" id="labelPreview">
    <div class="etiqueta" id="etiqueta">
      <div class="company">88ml Delivery Ltda</div>
      <div class="cnpj">CNPJ: 61.615.703/0001-19</div>
      <div class="divider"></div>

      <div class="product product-name" id="previewNome">ANCHO ESTÂNCIA 92</div>

      <div class="row">
        <div class="preco" id="previewPreco"><b>R$/kg:</b> R$0,00</div>
        <div class="peso" id="previewPeso"><b>Peso:</b> 0,000 kg</div>
      </div>

      <div class="divider"></div>

      <div class="total" id="previewTotal"><b>TOTAL:</b> <span class="total-value">R$0,00</span></div>
    </div>
  </div>

  <script>
    const nomeInput = document.getElementById('nome');
    const pesoInput = document.getElementById('peso');
    const precoInput = document.getElementById('preco');
    const totalInput = document.getElementById('total');

    const previewNome = document.getElementById('previewNome');
    const previewPeso = document.getElementById('previewPeso');
    const previewPreco = document.getElementById('previewPreco');
    const previewTotal = document.getElementById('previewTotal');

    function parseNumberBR(value){
      if(typeof value !== 'string') value = String(value);
      value = value.replace(/[^0-9,\.\-]/g,'');
      if(value === '') return NaN;
      if(value.indexOf(',')>-1 && value.indexOf('.')>-1){
        value = value.replace(/\./g,'').replace(',', '.');
      } else {
        value = value.replace(',', '.');
      }
      return parseFloat(value);
    }

    function formatPeso(value){
      if(isNaN(value)) return '0,000';
      return value.toFixed(3).replace('.', ',');
    }

    function formatMoneyBR(value){
      if(isNaN(value)) return 'R$0,00';
      return new Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL'}).format(value);
    }

    function maskInput(input, type){
      input.addEventListener('input', ()=>{
        let value = input.value;
        if(type==='peso'){
          value = value.replace(/[^0-9,]/g,'');
        } else if(type==='money'){
          value = value.replace(/[^0-9,]/g,'');
        }
        input.value = value;
      });
    }

    maskInput(pesoInput, 'peso');
    maskInput(precoInput, 'money');

    function atualizarPreview(){
      const nome = nomeInput.value.trim() || 'ANCHO ESTÂNCIA 92';
      const peso = parseNumberBR(pesoInput.value) || 0;
      const preco = parseNumberBR(precoInput.value) || 0;
      const total = peso * preco;

      previewNome.textContent = nome.toUpperCase();
      previewPreco.innerHTML = '<b>R$/kg:</b> ' + formatMoneyBR(preco);
      previewPeso.innerHTML = '<b>Peso:</b> ' + formatPeso(peso) + ' kg';
      previewTotal.innerHTML = '<b>TOTAL:</b> <span class="total-value">' + formatMoneyBR(total) + '</span>';

      totalInput.value = formatMoneyBR(total);
    }

    document.getElementById('atualizar').addEventListener('click',
 atualizarPreview);
    document.getElementById('imprimir').addEventListener('click', ()=>{
      atualizarPreview();
      window.print();
    });

    let timer;
    [nomeInput, pesoInput, precoInput].forEach(el=>{
      el.addEventListener('input', ()=>{
        clearTimeout(timer);
        timer = setTimeout(atualizarPreview, 300);
      })
    });

    atualizarPreview();
  </script>
</body>
</html>
