<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Impressão de Etiqueta 58mm — 88ml Delivery</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    :root{
  --label-width:58mm;
  --pad:6px;
  --line:#333;
  --font-family: 'Arial', sans-serif;
  --label-height: 30mm;   /* altura da etiqueta (conteúdo visível) */
  --gap-height: 20mm;     /* espaço fixo após a etiqueta (margem) */
  --page-height: calc(var(--label-height) + var(--gap-height)); /* total por "página" */
}
    body{
      font-family:var(--font-family);
      display:flex;
      gap:20px;
      padding:20px;
      flex-wrap:wrap;
      background:#f5f5f5; /* Cor de fundo do site */
    }

    /* Área de controles */
    .controls{min-width:320px;flex:1}
    label{display:block;margin:8px 0 4px;font-weight:600}
    input[type="text"], input[type="number"]{
      width:100%;
      padding:8px;
      font-size:16px;
      box-sizing:border-box;
      border-radius:8px; /* Arredondamento dos cantos */
      border:1px solid #ccc;
    }
    button{
      margin-top:12px;
      padding:10px 14px;
      font-size:16px;
      cursor:pointer;
      border-radius:8px; /* Arredondamento dos botões */
      border:none;
      background:#333;
      color:white;
    }

/* preview normal no site */
.label-preview{
  width:var(--label-width);
  /* REMOVIDO min-height enorme */
  padding:var(--pad);
  border:1px dashed #999;
  box-sizing:border-box;
  background:white;
  flex-shrink:0;
  border-radius:6px;
}

/* define área interna da etiqueta com altura fixa */
.etiqueta{
  width:100%;
  height: var(--label-height);
  box-sizing: border-box;
  overflow: hidden;
  display:block;
}

/* o spacer que aparece SOMENTE na impressão */
.print-gap{
  height: var(--gap-height);
  display:none;
}

/* --- estilo de impressão --- */
@media print {
  /* Esconder controles na hora de imprimir */
  .controls { display: none !important; }

  /* Force cada etiqueta como uma "página" com o tamanho total (etiqueta + gap) */
  @page {
    size: var(--label-width) var(--page-height);
    margin: 0;
  }

  /* Mostrar o spacer somente no print */
  .print-gap {
    display: block;
  }

  /* Garantir que a etiqueta quebre sempre e avance o papel */
  .label-preview {
    /* deixar visível e posicionada normalmente */
    position: static !important;
    box-shadow: none;
    border: none;
    page-break-after: always; /* antiga propriedade */
    break-after: page;        /* moderna */
  }

  /* evitar que o navegador reduza/encaixe o conteúdo */
  html, body {
    width: var(--label-width);
    height: var(--page-height);
    margin: 0;
    padding: 0;
  }
}

  </style>
</head>
<body>
  <div class="controls">
    <h2>Gerador de Etiqueta 58mm — 88ml</h2>

    <label for="nome">NOME:</label>
    <input id="nome" type="text" placeholder="INSERIR TÍTULO">

    <label for="peso">PESO (kg):</label>
    <input id="peso" type="text" placeholder="0,952">

    <label for="preco">R$/KG:</label>
    <input id="preco" type="text" placeholder="79,90">

    <label for="total">TOTAL:</label>
    <input id="total" type="text" readonly placeholder="Calculado automaticamente">

    <button id="atualizar">Atualizar Pré-visualização</button>
    <button id="imprimir">IMPRIMIR</button>

    <p style="margin-top:10px;font-size:12px;color:#444">Dica: use uma impressora térmica/laser configurada para papel de 58mm. O botão <strong>IMPRIMIR</strong> abrirá a janela de impressão do navegador exibindo apenas a etiqueta.</p>
  </div>

  <div class="label-preview" id="labelPreview">
    <div class="etiqueta" id="etiqueta">
      <div class="company">88ml Delivery Ltda</div>
      <div class="divider"></div>

      <div class="product product-name" id="previewNome">INSERIR TÍTULO</div>

      <div class="row">
        <div class="peso" id="previewPeso"><b>Peso:</b> 0,000 kg</div>
        <div class="peso" id="previewPreco"><b>R$/kg:</b> R$0,00</div>
      </div>

      <div class="divider"></div>

      <div class="total" id="previewTotal">TOTAL: R$0,00</div>
      <div class="print-gap"></div>
    </div>
  </div>

  <script>
    const nomeInput = document.getElementById('nome');
    const pesoInput = document.getElementById('peso');
    const precoInput = document.getElementById('preco');
    const totalInput = document.getElementById('total');

    const previewNome = document.getElementById('previewNome');
    const previewPeso = document.getElementById('previewPeso');
    const previewPreco = document.getElementById('previewPreco');
    const previewTotal = document.getElementById('previewTotal');

    function parseNumberBR(value){
      if(typeof value !== 'string') value = String(value);
      value = value.replace(/[^0-9,\.\-]/g,'');
      if(value === '') return NaN;
      if(value.indexOf(',')>-1 && value.indexOf('.')>-1){
        value = value.replace(/\./g,'').replace(',', '.');
      } else {
        value = value.replace(',', '.');
      }
      return parseFloat(value);
    }

    function formatPeso(value){
      if(isNaN(value)) return '0,000';
      return value.toFixed(3).replace('.', ',');
    }

    function formatMoneyBR(value){
      if(isNaN(value)) return 'R$0,00';
      return new Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL'}).format(value);
    }

    function atualizarPreview(){
      const nome = nomeInput.value.trim() || 'INSERIR TÍTULO';
      const peso = parseNumberBR(pesoInput.value) || 0;
      const preco = parseNumberBR(precoInput.value) || 0;
      const total = peso * preco;

      previewNome.textContent = nome.toUpperCase();
      previewPeso.innerHTML = '<b>Peso:</b> ' + formatPeso(peso) + ' kg';
      previewPreco.innerHTML = '<b>R$/kg:</b> ' + formatMoneyBR(preco);
      previewTotal.textContent = 'TOTAL: ' + formatMoneyBR(total);

      totalInput.value = formatMoneyBR(total);
    }

    document.getElementById('atualizar').addEventListener('click', atualizarPreview);
    document.getElementById('imprimir').addEventListener('click', ()=>{
      atualizarPreview();
      window.print();
    });

    let timer;
    [nomeInput, pesoInput, precoInput].forEach(el=>{
      el.addEventListener('input', ()=>{
        clearTimeout(timer);
        timer = setTimeout(atualizarPreview, 300);
      })
    });

    atualizarPreview();
  </script>
</body>
</html>
